<div class="container">
    <h1>Ticket List</h1>

    <!-- LOADING -->
    <p *ngIf="loading">Loading tickets...</p>

    <p *ngIf="!loading && tickets.length === 0">
      No tickets found.
    </p>

    <!-- ERROR -->
    <p *ngIf="error">Failed to load tickets</p>

  <div class="filter-bar">
    <button
      class="filter-btn"
      [class.active]="statusFilter === 'ALL'"
      (click)="statusFilter='ALL'; loadFilteredTickets()"
    >
      All
    </button>

    <button
      class="filter-btn badge--green"
      [class.active]="statusFilter === TicketStatus.Open"
      (click)="statusFilter=TicketStatus.Open; loadFilteredTickets()"
    >
      Open
    </button>

    <button
      class="filter-btn badge--red"
      [class.active]="statusFilter === TicketStatus.Closed"
      (click)="statusFilter=TicketStatus.Closed; loadFilteredTickets()"
    >
      Closed
    </button>

    <button
      class="filter-btn badge--orange"
      [class.active]="statusFilter === TicketStatus.Lost"
      (click)="statusFilter=TicketStatus.Lost; loadFilteredTickets()"
    >
      Lost
    </button>

    <input
      class="filter-input"
      type="text"
      placeholder="Search plate"
      [(ngModel)]="plateFilter"
      (input)="loadFilteredTickets()"
    />
  </div>


<div class="ticketWrapper" *ngIf="!loading && !error">

  <div class="ticketListGrid">
          <div
            class="card clickable ticket-card"
            *ngFor="let ticket of pagedTickets"
            [ngClass]="{
              'card--free': ticket.status === TicketStatus.Open,
              'card--occupied': ticket.status === TicketStatus.Closed,
              'card--unavailable': ticket.status === TicketStatus.Lost
            }"
          >

            <!-- SYMBOL -->
            <div class="parkingSymbol">
              <div class="symbolBox">
                <span class="first rectangle"></span>
                <span class="second rectangle"></span>
                <p id="parkingSymbolText">P</p>
              </div>
            </div>

            <!-- HEADER -->
            <div class="parkingTicketHeader">
              <h3>PARKING TICKET</h3>
              <p>Central Parking Lot</p>
            </div>

            <!-- VEHICLE INFO -->
            <div class="ticketInfo">
              <div class="holder">
                <p>Vehicle Plate:</p>
                <p id="vehiclePlate">{{ ticket.vehicle.plate }}</p>
              </div>

              <div class="holder">
                <p>Vehicle Type:</p>
                <p id="vehicleTypeLabel">{{ getVehicleTypeLabel(ticket.vehicle.type) }}</p>
              </div>

              <!--SPOT INFO-->
              <div class="holder">
                <p>Spot:</p>
                <p>{{ ticket.spotCode }}</p>
              </div>
            </div>

            <!-- TIME -->
            <div class="ticketDateData">
              <div class="date">
                <div class="entry time">
                  <p>FROM:</p>
                  <p>{{ ticket.entryTime | date:'HH:mm dd/MM/yyyy' }}</p>
                </div>
                <div
                  class="exit time"
                  *ngIf="ticket.status === TicketStatus.Closed">
                  <p>TO:</p>
                  <p>{{ ticket.exitTime | date:'HH:mm dd/MM/yyyy' }}</p>
                </div>

              </div>
            </div>

            <div class="ticketStatusHolder">
              <span
                class="badge"
                [ngClass]="{
                  'badge--green': ticket.status === TicketStatus.Open,
                  'badge--red': ticket.status === TicketStatus.Closed,
                  'badge--orange': ticket.status === TicketStatus.Lost
                }"
              >
                {{ getStatusLabel(ticket.status) }}
              </span>
            </div>

  </div>
</div>

      <!--PAGINATION-->
        <div class="pagination" *ngIf="totalPages > 1">
          <button class="btn" (click)="prevPage()" [disabled]="currentPage === 1">
            ◀ Prev
          </button>

          <span>Page {{ currentPage }} / {{ totalPages }}</span>

          <button class="btn" (click)="nextPage()" [disabled]="currentPage === totalPages">
            Next ▶
          </button>
        </div>

      <!-- ACTION BUTTONS -->
      <div class="actionButtons">
        <button class="btn btn--success" routerLink="entry-ticket">
          Entry Ticket
        </button>

        <button class="btn btn--danger" routerLink="exit-ticket">
          Exit Ticket
        </button>
      </div>

    </div>
</div>
